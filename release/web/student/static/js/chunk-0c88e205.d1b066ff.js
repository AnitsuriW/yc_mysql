(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c88e205"],{"105d":function(e,t,n){"use strict";n("f24e")},2927:function(e,t,n){"use strict";n.r(t);n("b0c0");var s=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{staticClass:"do-exam-title",staticStyle:{"background-color":"#F5F5DC"}},[t("el-col",{attrs:{span:24}},e._l(e.answer.answerItems,(function(n){return t("span",{key:n.itemOrder},[t("el-tag",{staticClass:"do-exam-title-tag",attrs:{type:e.questionDoRightTag(n.doRight)},on:{click:function(t){return e.goAnchor("#question-"+n.itemOrder)}}},[e._v(e._s(n.itemOrder))])],1)})),0)],1),t("el-row",{staticClass:"do-exam-hidden"},[t("el-col",{attrs:{span:24}},e._l(e.answer.answerItems,(function(n){return t("span",{key:n.itemOrder},[t("el-tag",{staticClass:"do-exam-title-tag"},[e._v(e._s(n.itemOrder))])],1)})),0)],1),t("el-container",{staticClass:"app-item-contain"},[t("el-header",{staticClass:"align-center"},[t("h1",[e._v(e._s(e.form.name))]),t("div",[t("span",{staticClass:"question-title-padding"},[e._v("试卷得分："+e._s(e.answer.score))]),t("span",{staticClass:"question-title-padding"},[e._v("试卷耗时："+e._s(e.formatSeconds(e.answer.doTime)))])])]),t("el-main",[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"form",attrs:{model:e.form,"label-width":"100px"}},e._l(e.form.titleItems,(function(n,s){return t("el-row",{key:s},[t("h3",[e._v(e._s(n.name))]),0!==n.questionItems.length?t("el-card",{staticClass:"exampaper-item-box question-background"},e._l(n.questionItems,(function(n){return t("el-form-item",{key:n.itemOrder,staticClass:"exam-question-item",attrs:{label:n.itemOrder+".","label-width":"50px",id:"question-"+n.itemOrder}},[t("QuestionAnswerShow",{attrs:{qType:n.questionType,question:n,answer:e.answer.answerItems[n.itemOrder-1]}}),t("el-button",{staticClass:"ai-analysis-btn",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleAiAnalysis(n)}}},[n.aiLoading?t("i",{staticClass:"el-icon-loading"}):t("span",[e._v("AI解析")])]),n.aiAnalysis?t("div",{staticClass:"ai-analysis-result"},[t("el-alert",{staticStyle:{color:"black"},attrs:{title:n.aiAnalysis||"暂无解析内容",type:"info"}})],1):e._e()],1)})),1):e._e()],1)})),1)],1)],1)],1)},i=[],a=n("5530"),r=n("ade3"),o=n("c7eb"),c=n("1da1"),l=(n("d9e2"),n("99af"),n("caad"),n("a15b"),n("d81d"),n("d3b7"),n("ac1f"),n("25f0"),n("5319"),n("498a"),n("159b"),n("2f62")),u=n("ed08"),d=n("ff3e"),p=n("ed24"),m={components:{QuestionAnswerShow:d["a"]},data:function(){return{form:{},formLoading:!1,answer:{id:null,score:0,doTime:0,answerItems:[],doRight:!1}}},created:function(){var e=this.$route.query.id,t=this;e&&0!==parseInt(e)&&(t.formLoading=!0,p["a"].read(e).then((function(e){t.form=e.response.paper,t.answer=e.response.answer,t.form.titleItems.forEach((function(e){e.questionItems.forEach((function(e){t.$set(e,"aiLoading",!1),t.$set(e,"aiAnalysis","")}))})),t.formLoading=!1}))),p["a"].read(e).then((function(e){console.log("题目数据:",e.response.paper.titleItems)}))},methods:Object(r["a"])({formatSeconds:function(e){return Object(u["a"])(e)},questionDoRightTag:function(e){return this.enumFormat(this.doRightTag,e)},goAnchor:function(e){this.$el.querySelector(e).scrollIntoView({behavior:"instant",block:"center",inline:"nearest"})},handleAiAnalysis:function(e){var t=this;return Object(c["a"])(Object(o["a"])().mark((function n(){var s,i,a,r,c,l,u,d;return Object(o["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,t.$api&&t.$api.ai){n.next=3;break}throw new Error("API 配置错误");case 3:if(t.$set(e,"aiLoading",!0),s=e.title||"",i="",![1,2].includes(e.questionType)){n.next=10;break}i=e.items.map((function(e){return"".concat(e.prefix,". ").concat(e.content)})).join("\n"),n.next=21;break;case 10:if(3!==e.questionType){n.next=14;break}i="正确\n错误",n.next=21;break;case 14:if(4!==e.questionType){n.next=21;break}return n.next=17,t.$nextTick();case 17:return n.next=19,new Promise((function(e){return setTimeout(e,50)}));case 19:a=t.$el.querySelector("#question-".concat(e.itemOrder," .gapfilling-span")),i=null!==a&&void 0!==a&&a.textContent?"填空位置示例：".concat(a.textContent):"填空位置未找到";case 21:if(s||i){n.next=23;break}throw new Error("题目和选项内容均为空");case 23:return r="".concat(s,"\n").concat(i).trim(),c=encodeURIComponent(r),console.log(c),n.next=28,t.$api.ai.analyzeQuestion({message:c});case 28:l=n.sent,u=l.code,d=l.response,1===u?t.$set(e,"aiAnalysis",d):t.$message.error("解析失败: "+(d||"未知错误")),n.next=37;break;case 34:n.prev=34,n.t0=n["catch"](0),t.$message.error(t.parseErrorMessage(n.t0));case 37:return n.prev=37,t.$set(e,"aiLoading",!1),n.finish(37);case 40:case"end":return n.stop()}}),n,null,[[0,34,37,40]])})))()},extractQuestionContent:function(e){return e.content||document.querySelector("#question-".concat(e.itemOrder," .q-title")).innerText},formatAiResponse:function(e){return e.replace(/\n/g,"<br>").replace(/\d+\./g,(function(e){return"<strong>".concat(e,"</strong>")}))},parseErrorMessage:function(e){var t;if(e.response)return"".concat(e.response.status," ").concat((null===(t=e.response.data)||void 0===t?void 0:t.message)||"服务异常");var n=e.message||e.toString();return n.replace(/^Error: /,"")}},"extractQuestionContent",(function(e){if(e.content)return e.content;var t=document.querySelector("#question-".concat(e.itemOrder," .q-title"));return t?t.innerText:"无法提取题目内容"})),extractQuestionContent:function(e){return e.content||document.querySelector("#question-".concat(e.itemOrder," .q-title")).innerText},computed:Object(a["a"])(Object(a["a"])({},Object(l["c"])("enumItem",["enumFormat"])),Object(l["e"])("enumItem",{doRightTag:function(e){return e.exam.question.answer.doRightTag}}))},f=m,q=(n("105d"),n("2877")),g=Object(q["a"])(f,s,i,!1,null,"ed5e3ee2",null);t["default"]=g.exports},"99af":function(e,t,n){"use strict";var s=n("23e7"),i=n("d039"),a=n("e8b5"),r=n("861d"),o=n("7b0b"),c=n("07fa"),l=n("3511"),u=n("8418"),d=n("65f0"),p=n("1dde"),m=n("b622"),f=n("1212"),q=m("isConcatSpreadable"),g=f>=51||!i((function(){var e=[];return e[q]=!1,e.concat()[0]!==e})),h=function(e){if(!r(e))return!1;var t=e[q];return void 0!==t?!!t:a(e)},v=!g||!p("concat");s({target:"Array",proto:!0,arity:1,forced:v},{concat:function(e){var t,n,s,i,a,r=o(this),p=d(r,0),m=0;for(t=-1,s=arguments.length;t<s;t++)if(a=-1===t?r:arguments[t],h(a))for(i=c(a),l(m+i),n=0;n<i;n++,m++)n in a&&u(p,m,a[n]);else l(m+1),u(p,m++,a);return p.length=m,p}})},caad:function(e,t,n){"use strict";var s=n("23e7"),i=n("4d64").includes,a=n("d039"),r=n("44d2"),o=a((function(){return!Array(1).includes()}));s({target:"Array",proto:!0,forced:o},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r("includes")},f24e:function(e,t,n){},ff3e:function(e,t,n){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qLoading,expression:"qLoading"}],staticStyle:{"line-height":"1.8"}},[1==e.qType||2==e.qType||3==e.qType||4==e.qType||5==e.qType?t("div",[1==e.qType?t("div",[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),t("div",{staticClass:"q-content"},[t("el-radio-group",{model:{value:e.answer.content,callback:function(t){e.$set(e.answer,"content",t)},expression:"answer.content"}},e._l(e.question.items,(function(n){return t("el-radio",{key:n.prefix,attrs:{label:n.prefix}},[t("span",{staticClass:"question-prefix"},[e._v(e._s(n.prefix)+".")]),t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(n.content)}})])})),1)],1)]):2==e.qType?t("div",[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),t("div",{staticClass:"q-content"},[t("el-checkbox-group",{model:{value:e.answer.contentArray,callback:function(t){e.$set(e.answer,"contentArray",t)},expression:"answer.contentArray"}},e._l(e.question.items,(function(n){return t("el-checkbox",{key:n.prefix,attrs:{label:n.prefix}},[t("span",{staticClass:"question-prefix"},[e._v(e._s(n.prefix)+".")]),t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(n.content)}})])})),1)],1)]):3==e.qType?t("div",[t("div",{staticClass:"q-title",staticStyle:{display:"inline","margin-right":"10px"},domProps:{innerHTML:e._s(e.question.title)}}),t("span",{staticStyle:{"padding-right":"10px"}},[e._v("(")]),t("el-radio-group",{model:{value:e.answer.content,callback:function(t){e.$set(e.answer,"content",t)},expression:"answer.content"}},e._l(e.question.items,(function(n){return t("el-radio",{key:n.prefix,attrs:{label:n.prefix}},[t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(n.content)}})])})),1),t("span",{staticStyle:{"padding-left":"10px"}},[e._v(")")])],1):4==e.qType?t("div",[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),null!==e.answer.contentArray?t("div",e._l(e.question.items,(function(n){return t("el-form-item",{key:n.prefix,staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{label:n.prefix,"label-width":"50px"}},[t("el-input",{model:{value:e.answer.contentArray[n.prefix-1],callback:function(t){e.$set(e.answer.contentArray,n.prefix-1,t)},expression:"answer.contentArray[item.prefix-1]"}})],1)})),1):e._e()]):5==e.qType?t("div",[t("div",{staticClass:"q-title",domProps:{innerHTML:e._s(e.question.title)}}),t("div",[t("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:e.answer.content,callback:function(t){e.$set(e.answer,"content",t)},expression:"answer.content"}})],1)]):e._e(),t("div",{staticClass:"question-answer-show-item",staticStyle:{"margin-top":"15px"}},[t("span",{staticClass:"question-show-item"},[e._v("结果：")]),t("el-tag",{attrs:{type:e.doRightTagFormatter(e.answer.doRight)}},[e._v(" "+e._s(e.doRightTextFormatter(e.answer.doRight))+" ")])],1),t("div",{staticClass:"question-answer-show-item"},[t("span",{staticClass:"question-show-item"},[e._v("分数：")]),t("span",[e._v(e._s(e.question.score))])]),t("div",{staticClass:"question-answer-show-item"},[t("span",{staticClass:"question-show-item"},[e._v("难度：")]),t("el-rate",{staticClass:"question-show-item",attrs:{disabled:""},model:{value:e.question.difficult,callback:function(t){e.$set(e.question,"difficult",t)},expression:"question.difficult"}})],1),t("br"),t("div",{staticClass:"question-answer-show-item",staticStyle:{"line-height":"1.8"}},[t("span",{staticClass:"question-show-item"},[e._v("解析：")]),t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(e.question.analyze)}})]),t("div",{staticClass:"question-answer-show-item"},[t("span",{staticClass:"question-show-item"},[e._v("正确答案：")]),1==e.qType||2==e.qType||5==e.qType?t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(e.question.correct)}}):e._e(),3==e.qType?t("span",{staticClass:"q-item-span-content",domProps:{innerHTML:e._s(e.trueFalseFormatter(e.question))}}):e._e(),4==e.qType?t("span",[e._v(e._s(e.question.correctArray))]):e._e()])]):t("div")])},i=[],a=n("5530"),r=(n("4de4"),n("a9e3"),n("d3b7"),n("2f62")),o={name:"QuestionShow",props:{question:{type:Object,default:function(){return{}}},answer:{type:Object,default:function(){return{id:null,content:"",contentArray:[],doRight:!1}}},qLoading:{type:Boolean,default:!1},qType:{type:Number,default:0}},methods:{trueFalseFormatter:function(e){return e.items.filter((function(t){return t.prefix===e.correct}))[0].content},doRightTagFormatter:function(e){return this.enumFormat(this.doRightTag,e)},doRightTextFormatter:function(e){return this.enumFormat(this.doRightEnum,e)}},computed:Object(a["a"])(Object(a["a"])({},Object(r["c"])("enumItem",["enumFormat"])),Object(r["e"])("enumItem",{doRightEnum:function(e){return e.exam.question.answer.doRightEnum},doRightTag:function(e){return e.exam.question.answer.doRightTag}}))},c=o,l=n("2877"),u=Object(l["a"])(c,s,i,!1,null,null,null);t["a"]=u.exports}}]);